<Window 
    x:Class="Names.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:Names.Helpers"    
    Title="Macro Recorder" 
    Height="700"
    Width="1080"
    Background="Black"
    SizeChanged="Window_SizeChanged"
    WindowStyle="None"
    AllowsTransparency="True"
    BorderThickness="1"
    BorderBrush="#FF333333"
    Icon="C:\Users\Admin\source\repos\Names\Resources\macro-recorder-icon.ico"
    ResizeMode="CanResizeWithGrip"
    Deactivated="On_WindowInBackground"
    Activated="On_WindowInForeground">

    <Window.Template>
        <ControlTemplate TargetType="{x:Type Window}">
            <Border BorderBrush="{TemplateBinding BorderBrush}" 
                    BorderThickness="{TemplateBinding BorderThickness}">
                <Grid>
                    <!-- Title bar -->
                    <Grid Height="30" VerticalAlignment="Top" Background="#FF222222">
                        <TextBlock Text="{TemplateBinding Title}" 
                                  Foreground="#FFFF0000" 
                                  VerticalAlignment="Center" 
                                  Margin="10,0,0,0" />
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button x:Name="MinimizeButton" Content="—" Width="30" Foreground="White"
                                    Background="Transparent" BorderThickness="0"
                                    Click="MinimizeButton_Click"/>
                            <Button x:Name="MaximizeButton" Content="□" Width="30" Foreground="White"
                                    Background="Transparent" BorderThickness="0"
                                    Click="MaximizeButton_Click"/>
                            <Button x:Name="CloseButton" Content="✕" Width="30" Foreground="White"
                                    Background="Transparent" BorderThickness="0"
                                    Click="CloseButton_Click"/>
                        </StackPanel>
                    </Grid>

                    <!-- Main content -->
                    <Border Margin="0,30,0,0">
                        <AdornerDecorator>
                            <ContentPresenter/>
                        </AdornerDecorator>
                    </Border>

                    <!-- Resize grip -->
                    <ResizeGrip x:Name="WindowResizeGrip" 
                                HorizontalAlignment="Right" 
                                VerticalAlignment="Bottom" 
                                Visibility="Visible" 
                                IsTabStop="False"/>
                </Grid>
            </Border>
        </ControlTemplate>
    </Window.Template>

    <Window.Resources>

        <!-- Window Background Styles -->
        <LinearGradientBrush x:Key="BackgroundBrush" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#1A1A2E" Offset="0.0"/>
            <GradientStop Color="#16213E" Offset="0.5"/>
            <GradientStop Color="#0F3460" Offset="1.0"/>
        </LinearGradientBrush>

        <!-- Modern Button Style -->
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="#2D2D30"/>
            <Setter Property="Foreground" Value="#FFFFFF"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        CornerRadius="4">
                            <Grid>
                                <Border x:Name="highlight" 
                                CornerRadius="4"
                                Background="#00FFFFFF" 
                                Opacity="0"/>
                                <ContentPresenter x:Name="contentPresenter"
                                          HorizontalAlignment="Center" 
                                          VerticalAlignment="Center"
                                          Margin="{TemplateBinding Padding}"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <!-- MouseOver state with subtle glow effect -->
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="highlight" Property="Opacity" Value="0.2"/>
                                <Setter TargetName="highlight" Property="Background" Value="#FFFFFF"/>
                                <Setter TargetName="border" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect ShadowDepth="0" BlurRadius="10" Opacity="0.3" Color="#AAAAAA"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <!-- Pressed state -->
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#222222"/>
                                <Setter TargetName="contentPresenter" Property="RenderTransform">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="0.98" ScaleY="0.98"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <!-- Disabled state -->
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Background" Value="#555555"/>
                                <Setter TargetName="border" Property="Opacity" Value="0.5"/>
                                <Setter TargetName="contentPresenter" Property="TextElement.Foreground" Value="#888888"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Circle Button Style -->
        <Style x:Key="CircleButton" TargetType="Button">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <Ellipse x:Name="ButtonEllipse" Fill="{TemplateBinding Background}"/>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="ButtonEllipse" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect ShadowDepth="0" BlurRadius="10" Opacity="0.3" Color="{Binding Background.Color, RelativeSource={RelativeSource TemplatedParent}}"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="ButtonEllipse" Property="Opacity" Value="0.8"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="ButtonEllipse" Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Width" Value="48"/>
            <Setter Property="Height" Value="48"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <!-- Action Button Styles (based on ModernButton) -->
        <Style x:Key="RecordButtonStyle" BasedOn="{StaticResource ModernButton}" TargetType="Button">
            <Setter Property="Background" Value="#E53935"/>
            <Setter Property="Foreground" Value="White"/>
            <Style.Triggers>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#C62828"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="StopButtonStyle" BasedOn="{StaticResource ModernButton}" TargetType="Button">
            <Setter Property="Background" Value="#424242"/>
            <Setter Property="Foreground" Value="White"/>
            <Style.Triggers>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#212121"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="PlayButtonStyle" BasedOn="{StaticResource ModernButton}" TargetType="Button">
            <Setter Property="Background" Value="#43A047"/>
            <Setter Property="Foreground" Value="White"/>
            <Style.Triggers>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#2E7D32"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="DarkButtonStyle" BasedOn="{StaticResource ModernButton}" TargetType="Button">
            <Setter Property="Background" Value="#212121"/>
            <Setter Property="Foreground" Value="#FF5252"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#444444"/>
            <Style.Triggers>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#1A1A1A"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="UtilityButtonStyle" BasedOn="{StaticResource ModernButton}" TargetType="Button">
            <Setter Property="Background" Value="#3F51B5"/>
            <Setter Property="Foreground" Value="White"/>
            <Style.Triggers>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#303F9F"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="SmallActionButtonStyle" BasedOn="{StaticResource ModernButton}" TargetType="Button">
            <Setter Property="Background" Value="#607D8B"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Style.Triggers>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#455A64"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Modern TextBox Style -->
        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="#1E1E1E"/>
            <Setter Property="Foreground" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#444444"/>
            <Setter Property="Padding" Value="8,5,8,5"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="border" 
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        CornerRadius="4">
                            <ScrollViewer x:Name="PART_ContentHost" 
                                  Focusable="False" 
                                  HorizontalScrollBarVisibility="Hidden" 
                                  VerticalScrollBarVisibility="Hidden"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="#FF5252"/>
                            </Trigger>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="#FF5252"/>
                                <Setter TargetName="border" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect ShadowDepth="0" BlurRadius="5" Opacity="0.3" Color="#FF5252"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Event Item Style -->
        <Style x:Key="EventItemStyle" TargetType="Border">
            <Setter Property="Background" Value="#22FFFFFF"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="Margin" Value="0,0,0,5"/>
            <Setter Property="Padding" Value="10,8"/>
        </Style>

        <!-- Icon Paths -->
        <PathGeometry x:Key="PlayIcon">M8 5.14v14l11-7-11-7z</PathGeometry>
        <PathGeometry x:Key="DeleteIcon">M6 18L18 6M6 6l12 12</PathGeometry>

    </Window.Resources>

    <Grid  Background="{StaticResource BackgroundBrush}">

        <!-- Content frame for pages (like Settings) -->
        <Frame x:Name="contentFrame" 
               Grid.ColumnSpan="2"
               NavigationUIVisibility="Hidden"
               Visibility="Collapsed"
               HorizontalAlignment="Stretch"
               VerticalAlignment="Stretch"/>

        <!-- Main content grid -->
        <Grid x:Name="mainContent">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            

        <!-- Left Sidebar -->
        <Border Grid.Column="0" Background="#22000000" BorderBrush="#444444" BorderThickness="0,0,1,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- App Logo/Title -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="15,20,15,20">
                    <Ellipse Width="36" Height="36" Fill="#E53935">
                        <Ellipse.Effect>
                            <DropShadowEffect BlurRadius="10" Opacity="0.3" ShadowDepth="0" Color="#FF5252"/>
                        </Ellipse.Effect>
                    </Ellipse>
                    <TextBlock Text="Macro Recorder" FontSize="18" FontWeight="SemiBold" Foreground="White" Margin="10,0,0,0" VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Saved Macros Header -->
                <TextBlock Grid.Row="1" Text="SAVED MACROS" FontSize="12" Foreground="#AAAAAA" Margin="15,0,15,10"/>

                <!-- Saved Macros List -->
                <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto" Margin="15,0,15,0">
                    <StackPanel x:Name="SavedMacrosList">
                        <!-- Macro Item 1 -->
                        <Border Background="#22FFFFFF" CornerRadius="4" Margin="0,0,0,5" Padding="10,8">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Login Sequence" VerticalAlignment="Center" Foreground="White"/>
                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                    <Button Style="{StaticResource ModernButton}" Width="28" Height="28" Background="Transparent" Padding="5" ToolTip="Edit Macro">
                                        <Path Data="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" 
                                              Fill="#AAAAAA" Stretch="Uniform"/>
                                    </Button>
                                    <Button Style="{StaticResource ModernButton}" Width="28" Height="28" Background="Transparent" Padding="5" ToolTip="Delete Macro">
                                        <Path Data="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" 
                                              Fill="#FF5252" Stretch="Uniform"/>
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Macro Item 2 -->
                        <Border Background="#22FFFFFF" CornerRadius="4" Margin="0,0,0,5" Padding="10,8">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Data Entry" VerticalAlignment="Center" Foreground="White"/>
                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                    <Button Style="{StaticResource ModernButton}" Width="28" Height="28" Background="Transparent" Padding="5" ToolTip="Edit Macro">
                                        <Path Data="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" 
                                              Fill="#AAAAAA" Stretch="Uniform"/>
                                    </Button>
                                    <Button Style="{StaticResource ModernButton}" Width="28" Height="28" Background="Transparent" Padding="5" ToolTip="Delete Macro">
                                        <Path Data="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" 
                                              Fill="#FF5252" Stretch="Uniform"/>
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Add New Macro Button -->
                        <Button Style="{StaticResource UtilityButtonStyle}" Height="40" Margin="0,10,0,0" Click="NewMacroButton_Click">
                            <StackPanel Orientation="Horizontal">
                                <Path Data="M12 4.5v15m7.5-7.5h-15" Stroke="White" StrokeThickness="2" Width="16" Height="16" Stretch="Uniform" Margin="0,0,8,0"/>
                                <TextBlock Text="New Macro" FontWeight="Medium"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </ScrollViewer>

                <!-- Settings Button -->
                <Button Grid.Row="3" Style="{StaticResource ModernButton}" Background="Transparent" Margin="15,20" Click="OpenSettings_Click">
                    <StackPanel Orientation="Horizontal">
                        <Path Data="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z" 
                              Stroke="#AAAAAA" StrokeThickness="1.5" Fill="Transparent" Width="20" Height="20" Stretch="Uniform" Margin="0,0,8,0"/>
                        <TextBlock Text="Settings" Foreground="#AAAAAA"/>
                    </StackPanel>
                </Button>
            </Grid>
        </Border>

        <!-- Main Content Area -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="60"/>
                <!-- Top Bar -->
                <RowDefinition Height="Auto"/>
                <!-- Control Panel -->
                <RowDefinition Height="*"/>
                <!-- Macro Events List -->
                <RowDefinition Height="30"/>
                <!-- Status Bar -->
            </Grid.RowDefinitions>

            <!-- Top Bar -->
            <Border Grid.Row="0" Background="#22000000" BorderBrush="#444444" BorderThickness="0,0,0,1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="20,0" VerticalAlignment="Center">
                        <TextBlock Text="Current Macro: " FontSize="16" Foreground="White" VerticalAlignment="Center"/>
                        <TextBlock Text="Untitled" FontSize="16" FontWeight="SemiBold" Foreground="#FF5252" VerticalAlignment="Center"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="20,0">
                        <Button x:Name="SaveButton" Style="{StaticResource DarkButtonStyle}" Width="40" Height="40" Margin="5,0" ToolTip="Save Macro" Click="SaveButton_Click">
                            <Path Data="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5" 
                                  Stroke="White" StrokeThickness="1.5" StrokeLineJoin="Round" Stretch="Uniform" Width="20" Height="20"/>
                        </Button>
                        <Button x:Name="LoadButton" Style="{StaticResource DarkButtonStyle}" Width="40" Height="40" Margin="5,0" ToolTip="Load Macro" Click="LoadButton_Click">
                            <Path Data="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" 
                                  Stroke="White" StrokeThickness="1.5"  StrokeLineJoin="Round" Stretch="Uniform" Width="20" Height="20"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Control Panel -->
            <Border Grid.Row="1" Background="#22000000" BorderBrush="#444444" BorderThickness="0,0,0,1" Padding="20,15">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Recording Controls -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0,0,20,0">
                        <Button x:Name="recordButton" Style="{StaticResource CircleButton}" Background="#E53935" Margin="0,0,10,0" ToolTip="Start Recording" Click="RecordButton_Click">
                            <Ellipse Width="20" Height="20" Fill="White"/>
                        </Button>
                        <Button x:Name="stopButton" Style="{StaticResource CircleButton}" Background="#424242" Margin="0,0,10,0" ToolTip="Stop Recording" Click="StopButton_Click">
                            <Rectangle Width="20" Height="20" Fill="White"/>
                        </Button>
                        <Button x:Name="playButton" Style="{StaticResource CircleButton}" Background="#43A047" Margin="0,0,10,0" ToolTip="Play Macro" Click="PlayButton_Click">
                            <Path Data="{StaticResource PlayIcon}" Fill="White" Stretch="Uniform" Width="20" Height="20"/>
                        </Button>
                    </StackPanel>

                    <!-- Separator -->
                    <Rectangle Grid.Column="1" Width="1" Margin="0,5" Fill="#444444" VerticalAlignment="Stretch"/>

                    <!-- Settings Controls -->
                    <WrapPanel Grid.Column="2" Margin="20,0,0,0" VerticalAlignment="Center">
                        <!-- Trigger Key -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,20,0">
                            <TextBlock x:Name="triggerKeyTextBox" Text="Trigger Key:" VerticalAlignment="Center" Foreground="#AAAAAA" Margin="0,0,10,0"/>
                            <Border Background="#22FFFFFF" CornerRadius="4" Padding="10,5" MinWidth="60">
                                <TextBlock x:Name="TriggerKeyDisplay" Text="{Binding TriggerKey}" HorizontalAlignment="Center" Foreground="White"/>
                            </Border>
                            <Button x:Name="recordTriggerButton" Content="Set" Style="{StaticResource UtilityButtonStyle}" Margin="5,0,0,0" Padding="10,5" Click="RecordTrigger_Click"/>
                        </StackPanel>

                        <!-- Loop Count -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,20,0">
                            <TextBlock Text="Loops:" VerticalAlignment="Center" Foreground="#AAAAAA" Margin="0,0,10,0"/>
                            <Button x:Name="decrementButton" Content="-" Style="{StaticResource SmallActionButtonStyle}" Width="30" Height="30" Padding="0" Click="DecrementLoop_Click"/>
                            <Border Background="#22FFFFFF" Width="40" Height="30" CornerRadius="0" BorderThickness="0">
                                <TextBox x:Name="loopCountTextBox" Text="{Binding LoopCount, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource ModernTextBox}" Background="Transparent" BorderThickness="0" TextAlignment="Center" VerticalContentAlignment="Center"/>
                            </Border>
                            <Button x:Name="incrementButton" Content="+" Style="{StaticResource SmallActionButtonStyle}" Width="30" Height="30" Padding="0" Click="IncrementLoop_Click"/>
                        </StackPanel>

                        <!-- Randomize Timing -->
                        <CheckBox x:Name="RandomizeTimingCheckBox" Click="RandomizeTimingCheckBox_Click" Content="Randomize Timing" Foreground="#AAAAAA" VerticalAlignment="Center" Margin="0,0,0,0"/>
                    </WrapPanel>
                </Grid>
            </Border>

            <!-- Macro Events List -->
            <Border Grid.Row="2" Margin="20" Background="#22000000" CornerRadius="8">
                <Grid Margin="20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="545*"/>
                        <ColumnDefinition Width="203*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Events Header -->
                    <TextBlock Grid.Row="0" Text="Recorded Events" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,15" Foreground="White" Grid.ColumnSpan="2"/>

                    <!-- Events List -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Grid.ColumnSpan="2">
                        <StackPanel x:Name="EventsList">
                            <!-- Additional event items would be generated dynamically based on recorded actions -->
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </Border>

            <!-- Status Bar -->
            <Border Grid.Row="3" Background="#22000000" BorderBrush="#444444" BorderThickness="0,1,0,0">
                <Grid>
                    <StackPanel Orientation="Horizontal" Margin="20,0">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Ellipse Width="8" Height="8" Fill="#43A047" Margin="0,0,5,0"/>
                            <TextBlock Text="Ready" Foreground="#AAAAAA" FontSize="12"/>
                        </StackPanel>

                        <TextBlock x:Name="eventsCountTextBlock" Text="Events: 0" Foreground="#AAAAAA" FontSize="12" Margin="20,0,0,0" VerticalAlignment="Center"/>
                        <TextBlock x:Name="durationTextBlock"  Text="Duration: 0s" Foreground="#AAAAAA" FontSize="12" Margin="20,0,0,0" VerticalAlignment="Center"/>

                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="20,0,0,0">
                            <Path Data="M16 5v2m0 10v2M5 10a7 7 0 1114 0 7 7 0 01-14 0z" Stroke="#AAAAAA" Width="12" Height="12" Stretch="Uniform" Margin="0,0,5,0"/>
                            <TextBlock Text="Loops: 1/1" Foreground="#AAAAAA" FontSize="12"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
        </Grid>
    </Grid>
</Window>